<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Manage Data</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #f1f5f9; padding: 20px; }
        .card { background: white; padding: 25px; border-radius: 15px; max-width: 500px; margin: auto; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .field { margin-bottom: 15px; }
        label { display: block; font-size: 0.8rem; font-weight: 800; margin-bottom: 5px; color: #64748b; }
        input, select { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .check-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; background: #f8fafc; padding: 10px; border-radius: 8px; margin-top: 10px; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: 800; margin-top: 10px; }
        .save { background: #3b82f6; color: white; }
        .back { background: #64748b; color: white; text-decoration: none; display: block; text-align: center; }
    </style>
</head>
<body>

<div class="card">
    <h2 style="margin-top:0">Update Data</h2>
    
    <div class="field">
        <label>Week</label>
        <select id="week" onchange="loadData()">
            <option value="week 1">Week 1</option>
            <option value="week 2">Week 2</option>
            <option value="week 3">Week 3</option>
        </select>
    </div>

    <div class="field">
        <label>Member Name</label>
        <input type="text" id="name" oninput="loadData()">
    </div>

    <div class="grid">
        <div class="field"><label>Power</label><input type="number" id="power"></div>
        <div class="field"><label>Points</label><input type="number" id="points"></div>
        <div class="field"><label>Hunt</label><input type="number" id="hunt" step="0.001"></div>
        <div class="field"><label>Quest</label><input type="number" id="quest"></div>
    </div>

    <div class="field">
        <label>Throne Points</label>
        <input type="number" id="throne">
    </div>

    <label>Activities</label>
    <div class="check-grid">
        <div><input type="checkbox" id="lava"> Lava</div>
        <div><input type="checkbox" id="challenge"> Challenge</div>
        <div><input type="checkbox" id="donations"> Donations</div>
        <div><input type="checkbox" id="esb"> ESB</div>
        <div><input type="checkbox" id="dv"> DV</div>
        <div><input type="checkbox" id="mon"> Mon</div>
        <div><input type="checkbox" id="wed"> Wed</div>
    </div>

    <label style="margin-top:15px">Picks</label>
    <div class="check-grid" style="background: #eff6ff;">
        <div><input type="checkbox" id="p100"> Pick 100</div>
        <div><input type="checkbox" id="p40"> Pick 40</div>
        <div><input type="checkbox" id="p20"> Pick 20</div>
        <div><input type="checkbox" id="p5"> Pick 5</div>
    </div>

    <button class="btn save" onclick="saveData()">SAVE DATA</button>
    <a href="index.html" class="btn back">CANCEL</a>
</div>

<script>
function loadData() {
    const name = document.getElementById('name').value.trim();
    const week = document.getElementById('week').value;
    if(!name) return;

    const data = JSON.parse(localStorage.getItem('formData') || '[]');
    const res = data.find(r => r.name.toLowerCase() === name.toLowerCase() && r.week === week);

    if(res) {
        document.getElementById('power').value = res.power || '';
        document.getElementById('points').value = res.points || '';
        document.getElementById('hunt').value = res.hunt || '';
        document.getElementById('quest').value = res.quest || '';
        document.getElementById('throne').value = res.throne || '';
        ['lava','challenge','donations','esb','dv','mon','wed','p100','p40','p20','p5'].forEach(id => {
            document.getElementById(id).checked = !!res[id];
        });
    }
}

function saveData() {
    const name = document.getElementById('name').value.trim();
    const week = document.getElementById('week').value;
    if(!name) return alert("Name required");

    let data = JSON.parse(localStorage.getItem('formData') || '[]');
    const entry = {
        name, week,
        power: parseFloat(document.getElementById('power').value) || 0,
        points: parseFloat(document.getElementById('points').value) || 0,
        hunt: parseFloat(document.getElementById('hunt').value) || 0,
        quest: parseFloat(document.getElementById('quest').value) || 0,
        throne: parseFloat(document.getElementById('throne').value) || 0,
        lava: document.getElementById('lava').checked,
        challenge: document.getElementById('challenge').checked,
        donations: document.getElementById('donations').checked,
        esb: document.getElementById('esb').checked,
        dv: document.getElementById('dv').checked,
        mon: document.getElementById('mon').checked,
        wed: document.getElementById('wed').checked,
        p100: document.getElementById('p100').checked,
        p40: document.getElementById('p40').checked,
        p20: document.getElementById('p20').checked,
        p5: document.getElementById('p5').checked
    };

    data = data.filter(r => !(r.name.toLowerCase() === name.toLowerCase() && r.week === week));
    data.push(entry);
    localStorage.setItem('formData', JSON.stringify(data));
    alert("Saved!");
}

window.onload = () => {
    const editName = localStorage.getItem('editTargetName');
    if(editName) {
        document.getElementById('name').value = editName;
        loadData();
        localStorage.removeItem('editTargetName');
    }
};
</script>
</body>
</html>
