<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Manage Alliance Data</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
--bg:#f1f5f9;
--text:#1e293b;
--card:#ffffff;
--accent:#3b82f6;
--success:#10b981;
--danger:#ef4444;
--dark-panel:#0f172a;
--muted:#64748b;
}

*{box-sizing:border-box}
body{margin:0;font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);}
header{background:#1e40af;color:#fff;padding:1.2rem 2rem;display:flex;justify-content:space-between;align-items:center;}
nav{display:flex;justify-content:center;gap:15px;padding:.75rem;background:#cbd5e1;}
nav a{color:#fff;text-decoration:none;padding:.6rem 1.2rem;background:var(--accent);border-radius:8px;font-weight:700;}

.main-wrap{
width:100%;
padding:1.5rem;
display:grid;
gap:1.5rem;
grid-template-columns:350px 1fr 350px;
align-items:start;
}

.section{
background:var(--card);
padding:1.5rem;
border-radius:16px;
box-shadow:0 10px 25px rgba(0,0,0,0.05);
}

/* ===== RIGHT SIDEBAR FLIP ===== */

.results-sidebar{
perspective:1200px;
position:sticky;
top:1.5rem;
}

.flip-card{
position:relative;
width:100%;
min-height:620px;
transform-style:preserve-3d;
transition:transform .6s;
cursor:pointer;
}

.flip-card.flipped{
transform:rotateY(180deg);
}

.flip-face{
position:absolute;
width:100%;
height:100%;
backface-visibility:hidden;
border-radius:20px;
padding:2rem;
}

.flip-front{
background:var(--dark-panel);
color:white;
}

.flip-back{
background:var(--dark-panel);
color:white;
transform:rotateY(180deg);
}

.res-item{
margin-bottom:1.2rem;
padding-bottom:.8rem;
border-bottom:1px solid #334155;
}
.res-item label{
font-size:.7rem;
color:#94a3b8;
text-transform:uppercase;
}
.res-item span{
font-size:1.5rem;
font-weight:800;
color:#60a5fa;
}

.rank-badge{
background:linear-gradient(135deg,#3b82f6 0%,#1e40af 100%);
text-align:center;
padding:1.5rem;
border-radius:15px;
margin-top:1.5rem;
}
.rank-val{
font-size:3.5rem;
font-weight:900;
display:block;
}

.pack-column{
display:flex;
flex-direction:column;
gap:12px;
margin-top:20px;
}

.pack-column label{
display:flex;
justify-content:space-between;
align-items:center;
font-size:.85rem;
color:white;
}

.pack-column input{
transform:scale(1.2);
}
</style>
</head>

<body>

<header>
<h1>Alliance Management</h1>
<div id="rosterCount">Players: 0</div>
</header>

<nav>
<a href="index.html">Dashboard</a>
<a href="trends.html">Trends</a>
<a href="form.html">Manage Data</a>
</nav>

<main class="main-wrap">

<!-- LEFT COLUMN (UNCHANGED) -->
<section class="section">
<h3>Directory</h3>
<input type="text" id="playerSearch" placeholder="ðŸ” Search players..." class="input" style="margin-bottom:10px;" oninput="renderList()">
<ul class="players-list" id="playersList"></ul>

<div style="margin-top:20px;padding-top:20px;border-top:2px solid #f1f5f9;">
<input id="playerNameInput" placeholder="Enter name + hit Enter..." class="input" style="border:2px solid var(--accent);">
<button class="btn" style="background:var(--success)" onclick="addNewPlayer()">Add to Roster</button>
</div>
</section>

<!-- MIDDLE COLUMN (FULLY RESTORED) -->
<section class="section">
<h2 id="editHeader">Select a Player</h2>

<div style="display:flex;gap:10px;margin-bottom:20px;">
<button onclick="setWeek('week 1')" class="week-btn selected" id="btn-week1">W1</button>
<button onclick="setWeek('week 2')" class="week-btn" id="btn-week2">W2</button>
<button onclick="setWeek('week 3')" class="week-btn" id="btn-week3">W3</button>
</div>

<div class="grid-2">
<div><label>Current Power</label><input id="f_power" type="number" class="input"></div>
<div><label>Total Points</label><input id="f_points" type="number" class="input"></div>
<div><label>Throne Kills</label><input id="f_throne" type="number" class="input"></div>
<div><label>Quest Score</label><input id="f_quest" type="number" class="input"></div>
<div><label>Ultimate Hunt</label><input id="f_hunt" type="number" class="input"></div>
</div>

<div style="display:flex;gap:15px;margin-top:30px;">
<button class="btn" style="background:var(--success);flex:2;" onclick="performSave()">SAVE DATA</button>
<button class="btn" style="background:var(--danger);flex:1;" onclick="deletePlayer()">DELETE</button>
</div>

</section>

<!-- RIGHT SIDEBAR FLIP -->
<aside class="results-sidebar">
<div class="flip-card" id="liveFlip" onclick="this.classList.toggle('flipped')">

<div class="flip-face flip-front">
<h3>Live Analysis</h3>
<div class="res-item"><label>Efficiency Score</label><span id="res_eff">0.0000</span></div>
<div class="res-item"><label>Hunt Score</label><span id="res_hunt">0.00</span></div>
<div class="res-item"><label>Throne Score</label><span id="res_throne">0.00</span></div>
<div class="res-item"><label>Total Score</label><span id="res_total">0.00</span></div>
<div class="rank-badge"><span class="rank-val" id="res_rank">#--</span></div>
</div>

<div class="flip-face flip-back">
<h3>KING PACK</h3>
<div class="pack-column">
<label>Legendary <input type="radio" name="pack"></label>
<label>Epic <input type="radio" name="pack"></label>
<label>Excellent <input type="radio" name="pack"></label>
<label>Rare (Dragon) <input type="radio" name="pack"></label>
<label>Rare (Hero) <input type="radio" name="pack"></label>
<label>Rare (Units) <input type="radio" name="pack"></label>
</div>
<div style="margin-top:30px;">
<label style="display:flex;justify-content:space-between;color:white;">Throne 1 <input type="checkbox"></label>
<label style="display:flex;justify-content:space-between;color:white;margin-top:10px;">Throne 2 <input type="checkbox"></label>
</div>
<p style="margin-top:40px;font-size:.75rem;color:#94a3b8;">Tap to return</p>
</div>

</div>
</aside>

</main>

<script>
(function(){
let currentPlayer=null,currentWeek='week 1';
const load=()=>JSON.parse(localStorage.getItem('formData')||'[]');
const save=d=>localStorage.setItem('formData',JSON.stringify(d));

window.setWeek=function(w){
currentWeek=w;
document.querySelectorAll('.week-btn').forEach(b=>b.classList.remove('selected'));
document.getElementById('btn-'+w.replace(' ','')).classList.add('selected');
};

window.selectPlayer=function(n){
currentPlayer=n;
document.getElementById('editHeader').textContent=n;
};

window.performSave=function(){
if(!currentPlayer)return;
let d=load();
const state={
name:currentPlayer,
week:currentWeek,
power:f_power.value,
points:f_points.value,
throne:f_throne.value,
quest:f_quest.value,
hunt:f_hunt.value
};
const i=d.findIndex(x=>x.name===currentPlayer&&x.week===currentWeek);
if(i>=0)d[i]=state;else d.push(state);
save(d);
alert("Saved");
};

window.addNewPlayer=function(){
const n=playerNameInput.value.trim();
if(!n)return;
let d=load();
['week 1','week 2','week 3'].forEach(w=>{
if(!d.find(x=>x.name===n&&x.week===w))d.push({name:n,week:w});
});
save(d);
playerNameInput.value="";
renderList();
};

window.deletePlayer=function(){
if(!currentPlayer)return;
let d=load().filter(x=>x.name!==currentPlayer);
save(d);
location.reload();
};

window.renderList=function(){
const d=load();
const names=[...new Set(d.map(x=>x.name))];
rosterCount.textContent="Players: "+names.length;
playersList.innerHTML=names.map(n=>`<li onclick="selectPlayer('${n}')">${n}</li>`).join('');
};

renderList();
})();
</script>

</body>
</html>